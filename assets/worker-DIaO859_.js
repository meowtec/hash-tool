this.document={currentScript:{src:this.location.href}},function(){"use strict";(async()=>{var T="https://meowtec.github.io/hash-tool/assets/hash_tool_bg-CYtFqt8j.wasm",A=async(t={},e)=>{let n;if(e.startsWith("data:")){const s=e.replace(/^data:.*?base64,/,"");let a;if(typeof Buffer=="function"&&typeof Buffer.from=="function")a=Buffer.from(s,"base64");else if(typeof atob=="function"){const i=atob(s);a=new Uint8Array(i.length);for(let r=0;r<i.length;r++)a[r]=i.charCodeAt(r)}else throw new Error("Cannot decode base64-encoded data URL");n=await WebAssembly.instantiate(a,t)}else{const s=await fetch(e),a=s.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&a.startsWith("application/wasm"))n=await WebAssembly.instantiateStreaming(s,t);else{const i=await s.arrayBuffer();n=await WebAssembly.instantiate(i,t)}}return n.instance.exports};let o;function S(t){o=t}const L=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let y=new L("utf-8",{ignoreBOM:!0,fatal:!0});y.decode();let u=null;function l(){return(u===null||u.byteLength===0)&&(u=new Uint8Array(o.memory.buffer)),u}function B(t,e){return t=t>>>0,y.decode(l().subarray(t,t+e))}let h=0;const E=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let f=new E("utf-8");const R=typeof f.encodeInto=="function"?function(t,e){return f.encodeInto(t,e)}:function(t,e){const n=f.encode(t);return e.set(n),{read:t.length,written:n.length}};function U(t,e,n){if(n===void 0){const _=f.encode(t),d=e(_.length,1)>>>0;return l().subarray(d,d+_.length).set(_),h=_.length,d}let s=t.length,a=e(s,1)>>>0;const i=l();let r=0;for(;r<s;r++){const _=t.charCodeAt(r);if(_>127)break;i[a+r]=_}if(r!==s){r!==0&&(t=t.slice(r)),a=n(a,s,s=r+t.length*3,1)>>>0;const _=l().subarray(a+r,a+s),d=R(t,_);r+=d.written,a=n(a,s,r,1)>>>0}return h=r,a}function z(t,e){const n=e(t.length*1,1)>>>0;return l().set(t,n/1),h=t.length,n}let g=null;function p(){return(g===null||g.byteLength===0)&&(g=new Int32Array(o.memory.buffer)),g}function k(t,e){return t=t>>>0,l().subarray(t/1,t/1+e)}const x=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>o.__wbg_hashdigest_free(t>>>0));class C{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,x.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_hashdigest_free(e)}constructor(e){const n=U(e,o.__wbindgen_malloc,o.__wbindgen_realloc),s=h,a=o.hashdigest_new(n,s);return this.__wbg_ptr=a>>>0,this}update(e){const n=z(e,o.__wbindgen_malloc),s=h;o.hashdigest_update(this.__wbg_ptr,n,s)}finalize(){try{const a=this.__destroy_into_raw(),i=o.__wbindgen_add_to_stack_pointer(-16);o.hashdigest_finalize(i,a);var e=p()[i/4+0],n=p()[i/4+1],s=k(e,n).slice();return o.__wbindgen_free(e,n*1,1),s}finally{o.__wbindgen_add_to_stack_pointer(16)}}}function K(t,e){throw new Error(B(t,e))}URL=globalThis.URL;const c=await A({"./hash_tool_bg.js":{__wbindgen_throw:K}},T),M=c.memory,W=c.__wbg_hashdigest_free,v=c.hashdigest_new,D=c.hashdigest_update,I=c.hashdigest_finalize,O=c.__wbindgen_malloc,j=c.__wbindgen_realloc,q=c.__wbindgen_add_to_stack_pointer,F=c.__wbindgen_free;var N=Object.freeze({__proto__:null,__wbg_hashdigest_free:W,__wbindgen_add_to_stack_pointer:q,__wbindgen_free:F,__wbindgen_malloc:O,__wbindgen_realloc:j,hashdigest_finalize:I,hashdigest_new:v,hashdigest_update:D,memory:M});S(N);const P=(t,e)=>({isTaskMessage:!0,type:t,data:e});class G{constructor(e){this.data=e}get byteLength(){return this.data.byteLength}read(e,n){const s=Math.min(n,this.byteLength-e);return Promise.resolve(new Uint8Array(this.data.buffer,this.data.byteOffset+e,this.data.byteOffset+e+s))}}class Y{constructor(e){this.data=e}get byteLength(){return this.data.size}async read(e,n){const s=await this.data.slice(e,e+n).arrayBuffer();return new Uint8Array(s)}}function b(t,e){globalThis.postMessage(P(t,e))}const H=1024*1024*8,w=new Set;function m(t){w.delete(t)}async function V({type:t,data:e,id:n}){const s=new C(t),a=e instanceof Blob?new Y(e):new G(e),{byteLength:i}=a;let r=0;for(w.add(n);r<i;){if(!w.has(n)){b("TASK_RESULT",{id:n,success:!1,error:"Task cancel"});return}const d=await a.read(r,H);s.update(d),r+=d.byteLength,b("TASK_PROGRESS",{id:n,processedBytes:r,totalBytes:i})}const _=s.finalize();m(n),b("TASK_RESULT",{id:n,hash:_,success:!0,totalBytes:i})}globalThis.onmessage=t=>{if(!t.data?.isTaskMessage)return;const e=t.data;e.type==="TASK_ADD"&&V(e.data).catch(n=>{b("TASK_RESULT",{id:e.data.id,success:!1,error:String(n)})}),e.type==="TASK_CANCEL"&&m(e.data.id)},globalThis.postMessage("INIT")})()}();
